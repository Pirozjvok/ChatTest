import{s as G,r as J,o as R,k as W}from"../chunks/scheduler.e3374dcb.js";import{S as x,i as K,g as v,s as b,h,j as S,y as L,c as q,f as T,k as n,a as F,x as u,B as I,z as H,d as N,t as O,b as Q,m as X,n as Y,o as Z,C as $,D as ee,p as te}from"../chunks/index.fa8ba58e.js";import{f as se,a as le}from"../chunks/index.a160e4ac.js";import{f as j}from"../chunks/fetch-refresh.d3a28ad6.js";function z(p){let t,e,i,_,r;return{c(){t=v("div"),e=X(p[2]),this.h()},l(l){t=h(l,"DIV",{class:!0});var a=S(t);e=Y(a,p[2]),a.forEach(T),this.h()},h(){n(t,"class","alert svelte-igqnli")},m(l,a){F(l,t,a),u(t,e),r=!0},p(l,a){(!r||a&4)&&Z(e,l[2])},i(l){r||(l&&W(()=>{r&&(_&&_.end(1),i=$(t,se,{y:-50,duration:500}),i.start())}),r=!0)},o(l){i&&i.invalidate(),l&&(_=ee(t,le,{})),r=!1},d(l){l&&T(t),l&&_&&_.end()}}}function ie(p){let t,e,i,_='<h1 class="svelte-igqnli">Вход</h1>',r,l,a,k="Почта:",y,c,P,g,U="Пароль:",M,d,D,C,E,w,V='<a href="/register" class="svelte-igqnli">Нет аккаунта? Зарегаться.</a>',A,B,s=p[2]&&z(p);return{c(){t=v("div"),e=v("form"),i=v("div"),i.innerHTML=_,r=b(),s&&s.c(),l=b(),a=v("label"),a.textContent=k,y=b(),c=v("input"),P=b(),g=v("label"),g.textContent=U,M=b(),d=v("input"),D=b(),C=v("input"),E=b(),w=v("div"),w.innerHTML=V,this.h()},l(f){t=h(f,"DIV",{class:!0});var m=S(t);e=h(m,"FORM",{class:!0});var o=S(e);i=h(o,"DIV",{class:!0,"data-svelte-h":!0}),L(i)!=="svelte-1grtk2d"&&(i.innerHTML=_),r=q(o),s&&s.l(o),l=q(o),a=h(o,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),L(a)!=="svelte-ud1yve"&&(a.textContent=k),y=q(o),c=h(o,"INPUT",{id:!0,class:!0,type:!0}),P=q(o),g=h(o,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),L(g)!=="svelte-11fw5v2"&&(g.textContent=U),M=q(o),d=h(o,"INPUT",{id:!0,class:!0,type:!0}),D=q(o),C=h(o,"INPUT",{class:!0,type:!0}),E=q(o),w=h(o,"DIV",{class:!0,"data-svelte-h":!0}),L(w)!=="svelte-1eipftr"&&(w.innerHTML=V),o.forEach(T),m.forEach(T),this.h()},h(){n(i,"class","login__header svelte-igqnli"),n(a,"for","email"),n(a,"class","login__label svelte-igqnli"),n(c,"id","email"),n(c,"class","login__input svelte-igqnli"),n(c,"type","email"),n(g,"for","passw"),n(g,"class","login__label svelte-igqnli"),n(d,"id","passw"),n(d,"class","login__input svelte-igqnli"),n(d,"type","password"),n(C,"class","btn svelte-igqnli"),n(C,"type","submit"),C.value="Войти",n(w,"class","login__register-link svelte-igqnli"),n(e,"class","login svelte-igqnli"),n(t,"class","container svelte-igqnli")},m(f,m){F(f,t,m),u(t,e),u(e,i),u(e,r),s&&s.m(e,null),u(e,l),u(e,a),u(e,y),u(e,c),I(c,p[0]),u(e,P),u(e,g),u(e,M),u(e,d),I(d,p[1]),u(e,D),u(e,C),u(e,E),u(e,w),A||(B=[H(c,"input",p[4]),H(d,"input",p[5]),H(e,"submit",p[3])],A=!0)},p(f,[m]){f[2]?s?(s.p(f,m),m&4&&N(s,1)):(s=z(f),s.c(),N(s,1),s.m(e,l)):s&&(te(),O(s,1,1,()=>{s=null}),Q()),m&1&&c.value!==f[0]&&I(c,f[0]),m&2&&d.value!==f[1]&&I(d,f[1])},i(f){N(s)},o(f){O(s)},d(f){f&&T(t),s&&s.d(),A=!1,J(B)}}}function ae(p,t,e){let i,_,r=null;R(async()=>{(await j("/User.Get",{credentials:"same-origin"})).ok&&(window.location.href="/chat")});async function l(){const y=await j("/Auth/Login",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i,password:_})});y.ok?window.location.href="/chat":y.status===401?(e(2,r="Неверный логин или пароль"),await new Promise(c=>setTimeout(c,3e3)),e(2,r=null)):(e(2,r="Неизвестная ошибка"),await new Promise(c=>setTimeout(c,3e3)),e(2,r=null))}function a(){i=this.value,e(0,i)}function k(){_=this.value,e(1,_)}return[i,_,r,l,a,k]}class fe extends x{constructor(t){super(),K(this,t,ae,ie,G,{})}}export{fe as component};
